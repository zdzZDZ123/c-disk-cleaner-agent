2025-05-24 11:48:35.817 | INFO     | config.manager:load_config:49 - 从 C:\Users\lisiy\.c_disk_cleaner\config.yaml 加载配置
2025-05-24 11:48:35.837 | INFO     | data.database:init_database:144 - 数据库初始化完成: C:\Users\lisiy\.c_disk_cleaner\cleaner.db
2025-05-24 11:48:35 | INFO     | data.database:init_database:144 - 数据库初始化完成: C:\Users\lisiy\.c_disk_cleaner\cleaner.db
2025-05-24 11:48:35 | WARNING  | services.task_manager:__init__:56 - TaskManager did not receive AIPlannerService, attempting to initialize it internally.
2025-05-24 11:48:35 | INFO     | services.ai_planner:_load_api_keys:58 - 开始加载AI模型API密钥...
2025-05-24 11:48:35 | INFO     | services.ai_planner:_load_api_keys:62 - 环境变量 GEMINI_API_KEY: 未设置
2025-05-24 11:48:35 | INFO     | services.ai_planner:_load_api_keys:63 - 环境变量 QWEN_API_KEY: 未设置
2025-05-24 11:48:35 | INFO     | services.ai_planner:_load_api_keys:77 - 配置文件加载状态: 成功
2025-05-24 11:48:35 | INFO     | services.ai_planner:_load_api_keys:90 - AI配置字段: ['gemini_api_key', 'qwen_api_key', 'wenxin_api_key']
2025-05-24 11:48:35 | INFO     | services.ai_planner:_load_api_keys:95 - 配置文件中 gemini_api_key: 已设置
2025-05-24 11:48:35 | INFO     | services.ai_planner:_load_api_keys:96 - 配置文件中 qwen_api_key: 已设置
2025-05-24 11:48:35 | INFO     | services.ai_planner:_load_api_keys:99 - 从配置文件加载了Gemini API密钥
2025-05-24 11:48:35 | INFO     | services.ai_planner:_load_api_keys:102 - 从配置文件加载了Qwen API密钥
2025-05-24 11:48:35 | INFO     | services.ai_planner:_load_api_keys:115 - 成功加载的API模型: ['gemini', 'qwen']
2025-05-24 11:48:35 | INFO     | services.ai_planner:__init__:51 - AI Planner Service 成功初始化，使用Qwen模型。
2025-05-24 11:48:36 | INFO     | services.ai_planner:_load_api_keys:58 - 开始加载AI模型API密钥...
2025-05-24 11:48:36 | INFO     | services.ai_planner:_load_api_keys:62 - 环境变量 GEMINI_API_KEY: 未设置
2025-05-24 11:48:36 | INFO     | services.ai_planner:_load_api_keys:63 - 环境变量 QWEN_API_KEY: 未设置
2025-05-24 11:48:36 | INFO     | services.ai_planner:_load_api_keys:77 - 配置文件加载状态: 成功
2025-05-24 11:48:36 | INFO     | services.ai_planner:_load_api_keys:90 - AI配置字段: ['gemini_api_key', 'qwen_api_key', 'wenxin_api_key']
2025-05-24 11:48:36 | INFO     | services.ai_planner:_load_api_keys:95 - 配置文件中 gemini_api_key: 已设置
2025-05-24 11:48:36 | INFO     | services.ai_planner:_load_api_keys:96 - 配置文件中 qwen_api_key: 已设置
2025-05-24 11:48:36 | INFO     | services.ai_planner:_load_api_keys:99 - 从配置文件加载了Gemini API密钥
2025-05-24 11:48:36 | INFO     | services.ai_planner:_load_api_keys:102 - 从配置文件加载了Qwen API密钥
2025-05-24 11:48:36 | INFO     | services.ai_planner:_load_api_keys:115 - 成功加载的API模型: ['gemini', 'qwen']
2025-05-24 11:48:36 | INFO     | services.ai_planner:__init__:51 - AI Planner Service 成功初始化，使用Qwen模型。
2025-05-24 11:48:36 | INFO     | __main__:initialize_app:101 - 应用程序组件初始化成功。
2025-05-24 11:48:36 | INFO     | __main__:run_ai_plan:186 - 分析路径: ['C:\\']
2025-05-24 11:48:36 | INFO     | __main__:run_ai_plan:187 - 排除路径: []
2025-05-24 11:48:36 | INFO     | services.ai_planner:generate_plan:226 - 正在使用Qwen模型生成清理计划...
2025-05-24 11:48:36 | INFO     | services.ai_planner:_generate_plan_with_qwen:505 - 向Qwen发送提示 (尝试 1/3): 用户目标: 清理下载文件夹中的大文件和重复文件

当前上下文: {'system_info': {'os': 'Windows', 'free_disk_space_gb': 0}, 'user_preferences': {'keep_files_newer_than_days': 30}, 'scan_paths': ['C:\\'], 'exclude_paths': []}

根据用户目标...
2025-05-24 11:48:40 | INFO     | services.ai_planner:_generate_plan_with_qwen:582 - 从Qwen成功接收并解析计划

使用 Qwen 模型生成清理计划...


===== 多轮对话交互模式 =====

您可以与AI进行多轮对话，细化清理目标或实时调整计划。
输入'确认'接受当前计划，输入'退出'结束对话。

目标: 清理下载文件夹中的大文件和重复文件
正在生成清理计划，请稍候...

生成的清理计划如下：

AI 生成的清理计划:
  步骤 1: scan_paths
    描述: 扫描指定路径
    参数: {'paths': ['C:\\Users\\User\\Downloads'], 'exclude_patterns': ['*.log']}
  步骤 2: identify_file_categories
    描述: 识别文件类别
    参数: {'categories': ['large_files', 'duplicates']}
  步骤 3: suggest_deletions
    描述: 建议删除无用文件
    参数: {'file_age_threshold_days': 30}
  步骤 4: perform_cleanup
    描述: 执行清理操作

请提供反馈或输入'确认'接受计划，输入'退出'结束对话: 2025-05-24 12:56:39 | INFO     | __main__:signal_handler:140 - 收到信号 2，准备关闭...
2025-05-24 12:56:39 | INFO     | __main__:cleanup_app:114 - 正在关闭应用程序...
2025-05-24 12:56:39 | INFO     | services.scheduler:stop:79 - 调度器服务已停止
2025-05-24 12:56:39 | INFO     | services.task_manager:close:645 - 开始关闭任务管理器...
2025-05-24 12:56:39 | INFO     | services.task_manager:close:659 - 关闭日志服务...
2025-05-24 12:56:39 | INFO     | services.task_manager:close:671 - 关闭数据库连接...
2025-05-24 12:56:39 | INFO     | services.task_manager:close:679 - 任务管理器已关闭
2025-05-24 12:56:39 | INFO     | services.scheduler:close:376 - 调度器服务已关闭
2025-05-24 12:56:39 | INFO     | __main__:cleanup_app:119 - 调度器已关闭。
2025-05-24 12:56:39 | INFO     | services.task_manager:close:645 - 开始关闭任务管理器...
2025-05-24 12:56:39 | INFO     | services.task_manager:close:659 - 关闭日志服务...
2025-05-24 12:56:39 | INFO     | services.task_manager:close:679 - 任务管理器已关闭
2025-05-24 12:56:39 | INFO     | __main__:cleanup_app:126 - 任务管理器已关闭。
2025-05-24 12:56:39 | INFO     | __main__:cleanup_app:134 - 应用程序已关闭。
2025-05-24 12:56:39 | INFO     | __main__:cleanup_app:114 - 正在关闭应用程序...
2025-05-24 12:56:39 | INFO     | services.scheduler:stop:79 - 调度器服务已停止
2025-05-24 12:56:39 | INFO     | services.task_manager:close:645 - 开始关闭任务管理器...
2025-05-24 12:56:39 | INFO     | services.task_manager:close:659 - 关闭日志服务...
2025-05-24 12:56:39 | INFO     | services.task_manager:close:679 - 任务管理器已关闭
2025-05-24 12:56:39 | INFO     | services.scheduler:close:376 - 调度器服务已关闭
2025-05-24 12:56:39 | INFO     | __main__:cleanup_app:119 - 调度器已关闭。
2025-05-24 12:56:39 | INFO     | services.task_manager:close:645 - 开始关闭任务管理器...
2025-05-24 12:56:39 | INFO     | services.task_manager:close:659 - 关闭日志服务...
2025-05-24 12:56:39 | INFO     | services.task_manager:close:679 - 任务管理器已关闭
2025-05-24 12:56:39 | INFO     | __main__:cleanup_app:126 - 任务管理器已关闭。
2025-05-24 12:56:39 | INFO     | __main__:cleanup_app:134 - 应用程序已关闭。
